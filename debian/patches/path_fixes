From: Adam Majer <adamm@zombino.com>
Date: Fri, 13 Jul 2018 17:06:51 +0000
Subject: path_fixes

---
 src/lib/dhcpsrv/Makefile.in                        | 2 +-
 src/lib/dhcpsrv/daemon.cc                          | 2 +-
 src/lib/log/interprocess/Makefile.in               | 2 +-
 src/lib/log/interprocess/interprocess_sync_file.cc | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/src/lib/dhcpsrv/Makefile.in b/src/lib/dhcpsrv/Makefile.in
index d58f48f..ef8c1f6 100644
--- a/src/lib/dhcpsrv/Makefile.in
+++ b/src/lib/dhcpsrv/Makefile.in
@@ -657,7 +657,7 @@ top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
 AUTOMAKE_OPTIONS = subdir-objects
 SUBDIRS = . testutils tests benchmarks
-dhcp_data_dir = @localstatedir@/@PACKAGE@
+dhcp_data_dir = @localstatedir@/lib/@PACKAGE@
 kea_lfc_location = @prefix@/sbin/kea-lfc
 # Set location of the kea-lfc binary.
 AM_CPPFLAGS = -I$(top_builddir)/src/lib -I$(top_srcdir)/src/lib \
diff --git a/src/lib/dhcpsrv/daemon.cc b/src/lib/dhcpsrv/daemon.cc
index fd06e8b..c621479 100644
--- a/src/lib/dhcpsrv/daemon.cc
+++ b/src/lib/dhcpsrv/daemon.cc
@@ -29,7 +29,7 @@ namespace dhcp {
 
 Daemon::Daemon()
     : signal_set_(), signal_handler_(), config_file_(""), proc_name_(""),
-    pid_file_dir_(DHCP_DATA_DIR), pid_file_(), am_file_author_(false) {
+    pid_file_dir_("/var/run"), pid_file_(), am_file_author_(false) {
 
     // The pid_file_dir can be overridden via environment variable
     // This is primarily intended to simplify testing
diff --git a/src/lib/log/interprocess/Makefile.in b/src/lib/log/interprocess/Makefile.in
index 1fe5608..fc9e30b 100644
--- a/src/lib/log/interprocess/Makefile.in
+++ b/src/lib/log/interprocess/Makefile.in
@@ -418,7 +418,7 @@ top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
 SUBDIRS = . tests
 AM_CPPFLAGS = -I$(top_srcdir)/src/lib -I$(top_builddir)/src/lib \
-	-DLOCKFILE_DIR=\"$(localstatedir)/run/$(PACKAGE_NAME)\" \
+	-DLOCKFILE_DIR=\"$(localstatedir)/run\" \
 	$(BOOST_INCLUDES)
 AM_CXXFLAGS = $(KEA_CXXFLAGS)
 CLEANFILES = *.gcno *.gcda
diff --git a/src/lib/log/interprocess/interprocess_sync_file.cc b/src/lib/log/interprocess/interprocess_sync_file.cc
index ed6a5b7..b89cc3a 100644
--- a/src/lib/log/interprocess/interprocess_sync_file.cc
+++ b/src/lib/log/interprocess/interprocess_sync_file.cc
@@ -50,7 +50,7 @@ InterprocessSyncFile::do_lock(int cmd, short l_type) {
             lockfile_path = env;
         }
 
-        lockfile_path += "/" + task_name_ + "_lockfile";
+        lockfile_path += "/isc_kea_" + task_name_ + "_lockfile";
 
         // Open the lockfile in the constructor so it doesn't do the access
         // checks every time a message is logged.
